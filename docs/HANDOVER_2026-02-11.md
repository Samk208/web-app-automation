# WonLink AI Automation Agency — Handover Notes

> **Date:** February 11, 2026
> **Reviewer:** AI Code Assistant (full codebase audit)
> **Previous handover:** January 24, 2026 (`PRODUCTION_READY_ORCHESTRATOR_HANDOVER.md`)

---

## 1. Executive Summary

WonLink is a **multi-agent AI automation platform** for Korean businesses built on Next.js 16.1.1 with Supabase, LangGraph, and the Vercel AI SDK. It provides **10 specialized agents** across 4 sectors, an orchestrator for multi-agent routing, and a modern dashboard UI.

**Overall assessment: ~75% production-ready.**

- Infrastructure and security are solid (100%).
- All 13 dashboard pages exist with real server actions and database integration.
- 4 agents depend on external scrapers/APIs that require proxy configuration.
- No automated tests exist.
- No CI/CD pipeline.
- Documentation is heavily fragmented and internally contradictory.

---

## 2. Tech Stack

| Layer | Technology | Version |
|---|---|---|
| Framework | Next.js (App Router) | 16.1.1 |
| UI | React | 19.2.3 |
| Styling | Tailwind CSS | 4.x |
| Animation | Framer Motion | 12.x |
| Database & Auth | Supabase (Postgres 17) | 2.89.0 |
| AI Models | Gemini, GPT, Anthropic | via Vercel AI SDK 6.x |
| Orchestration | LangGraph | 1.0.7 |
| Caching/Rate Limit | Upstash Redis | 1.36.0 |
| Payments | Stripe | 20.1.0 |
| Document Gen | MCP SDK | 1.25.1 |
| Web Scraping | Playwright | 1.57.0 |
| Observability | LangSmith | 0.4.4 |

---

## 3. Infrastructure Status

All infrastructure components are implemented and functional:

| Component | File(s) | Status |
|---|---|---|
| Auth (SSR cookies) | `src/middleware.ts`, `src/lib/supabase/` | Done |
| RBAC / Org-scoped access | `src/lib/auth/authorization.ts`, `src/lib/org.ts` | Done |
| Rate limiting (Redis) | `src/lib/rate-limit.ts`, `src/lib/rate-limit-redis.ts` | Done |
| AI cost tracking | `src/lib/ai/cost-tracker.ts`, `src/lib/ai/cost-guard.ts` | Done |
| Budget enforcement (5 tiers) | `src/lib/ai/cost-guard.ts` | Done |
| Input validation (Zod) | `src/lib/validation/schemas.ts`, `src/lib/guard.ts` | Done |
| CSRF protection | `src/lib/csrf.ts` | Done |
| Error handling / sanitization | `src/lib/error-handler.ts` | Done |
| Structured logging | `src/lib/logger.ts` | Done |
| Correlation IDs | `src/lib/correlation.ts`, `src/middleware.ts` | Done |
| LangSmith tracing | `src/lib/observability/langsmith-wrapper.ts` | Done |
| Feature flags / mock protection | `src/lib/feature-flags.ts` | Done |
| MCP document generation | `src/lib/mcp/`, `src/app/api/mcp/` | Done |
| Stripe client | `src/lib/stripe/client.ts` | Done |
| Redis client | `src/lib/redis.ts` | Done |

---

## 4. Database Schema

**24 migrations** applied. Key tables (all RLS-enabled, org-scoped):

| Table | Purpose |
|---|---|
| `organizations` | Multi-tenant orgs |
| `profiles` | User profiles (linked to `auth.users`) |
| `memberships` | Org membership with roles (owner/admin/member/viewer) |
| `agent_systems` | Agent configurations per org |
| `agent_definitions` | Agent role definitions |
| `workflow_definitions` | Workflow templates |
| `workflow_runs` | Execution instances |
| `workflow_steps` | Granular step logs |
| `workflow_states` | LangGraph state persistence |
| `approval_requests` | HITL approval queue |
| `business_plans` | PSST business plans |
| `proposals` | Consulting proposals (Stripe-integrated) |
| `sourcing_tasks` | 1688 product sourcing |
| `seo_audits` | Naver SEO audits |
| `reconciliation_jobs` | Bank reconciliation |
| `safety_logs` | Safety compliance logs |
| `hwp_jobs` | HWP conversion queue |
| `ai_usage_logs` | AI cost tracking |
| `startup_programs` | K-Startup program catalog |
| `knowledge_base` | Org-scoped knowledge base |
| `messages` | Chat/Kakao messages |

**RLS policies:** All tables enforce organization-scoped access via `is_org_member()` and `has_org_role()` helper functions.

---

## 5. Agent Inventory (All 10 + Orchestrator)

### 5.1 Fully Functional Agents (real logic, real DB, real UI)

| # | Agent | Route | Server Action | DB Table |
|---|---|---|---|---|
| 1 | Business Plan Master | `/dashboard/business-plan-master` | `business-plan.ts` | `business_plans` |
| 2 | Grant Scout | `/dashboard/grant-scout` | `grant-scout.ts` | `grant_applications` |
| 3 | Proposal Architect | `/dashboard/proposal-gen` | `proposal.ts` | `proposals` |
| 4 | Global Merchant | `/dashboard/global-merchant` | `merchant.ts` | `localizations` |
| 5 | K-Startup Navigator | `/dashboard/k-startup-navigator` | `k-startup.ts` | `program_matches` |
| 6 | Safety Guardian | `/dashboard/smart-factory` | `safety-guardian.ts` | `safety_logs` |
| 7 | Ledger Logic | `/dashboard/reconciliation` | `reconciliation.ts` | `reconciliation_jobs` |
| 8 | China Source Pro | `/dashboard/china-source` | `sourcing.ts` | `sourcing_tasks` |
| 9 | Naver SEO Pro | `/dashboard/naver-seo` | `naver-seo.ts` | `seo_audits` |
| 10 | Trade Agent | `/dashboard/trade-agent` | (direct Supabase) | `orders` |
| — | Orchestrator | `/dashboard/orchestrator` | `orchestrator.ts` | (via sub-agents) |

### 5.2 Data Source Maturity

| Agent | Data Source | Maturity |
|---|---|---|
| Business Plan Master | Perplexity API + KOSIS + AI generation | Production |
| Grant Scout | AI matching + startup_programs table | Production |
| Proposal Architect | RAG from knowledge_base + web scraping | Production |
| Global Merchant | AI cultural localization | Production |
| K-Startup Navigator | K-Startup scraper + seed data | Needs proxy |
| Safety Guardian | Simulated IoT sensors + AI compliance | Demo/simulated input |
| Ledger Logic | Mock CSV upload + fuzzy matching | Demo/simulated input |
| China Source Pro | 1688 scraper | Needs proxy |
| Naver SEO Pro | Naver crawler | Needs proxy / simulated |
| Trade Agent | Simulated order data + dual-use detection | Demo/simulated input |
| Orchestrator | LangGraph multi-agent routing | Production |

### 5.3 Common Page Architecture

All agent pages follow a consistent pattern:
1. Input form / controls
2. Server action call on submit
3. Real-time Supabase subscription for status updates
4. Status indicators (IDLE → PROCESSING → COMPLETED)
5. Animated results display
6. Reset functionality

---

## 6. Frontend Pages

### 6.1 Public Pages

| Route | Status | Notes |
|---|---|---|
| `/` | Complete | Landing with hero, scrollytelling, deep-tech showcase |
| `/login` | Complete | Email/password auth via Supabase |
| `/pricing` | Complete | 3 tiers (Starter, Pro, Enterprise) |
| `/features` | Complete | 6 capabilities showcase |
| `/blog` | Placeholder | "Insights Coming Soon" |
| `/docs` | Placeholder | "Under Construction" |
| `/error` | Complete | Error boundary page |

### 6.2 Dashboard Pages (auth-protected)

| Route | Status | Notes |
|---|---|---|
| `/dashboard` | Complete | Command center with metrics + WelcomeChat |
| `/dashboard/business-plan-master` | Complete | Full PSST workflow + HWP |
| `/dashboard/business-plan-master/[id]/review` | Complete | HITL review flow |
| `/dashboard/grant-scout` | Complete | Grant matching + draft generation |
| `/dashboard/grant-scout/[id]/review` | Complete | HITL review flow |
| `/dashboard/proposal-gen` | Complete | RAG-powered proposals |
| `/dashboard/global-merchant` | Complete | Cultural localization |
| `/dashboard/k-startup-navigator` | Complete | Government program matching |
| `/dashboard/naver-seo` | Complete | SEO audit tool |
| `/dashboard/china-source` | Complete | Product sourcing + pricing |
| `/dashboard/smart-factory` | Complete | Safety monitoring |
| `/dashboard/reconciliation` | Complete | Financial reconciliation |
| `/dashboard/trade-agent` | Complete | Export compliance |
| `/dashboard/orchestrator` | Complete | Multi-agent chat |
| `/dashboard/canary` | Complete | Component showcase (dev tool) |

---

## 7. API Routes

| Endpoint | Method | Purpose |
|---|---|---|
| `/api/hwp/jobs` | POST | HWP file conversion jobs |
| `/api/kakao/webhook` | POST | Kakao chatbot webhook (HMAC verified) |
| `/api/kakao/mock` | POST | Kakao testing endpoint |
| `/api/mcp/document-generator` | POST | MCP Korean document generation |
| `/api/observability/stats` | GET | AI cost analytics |
| `/api/reviews/[id]/approve` | POST | HITL approval endpoint |
| `/api/proposals/[id]/accept` | POST | Proposal acceptance + Stripe subscription |

---

## 8. Key Libraries & Utilities

| Directory | Contents |
|---|---|
| `src/lib/ai/` | Model providers, cost tracking, budget enforcement |
| `src/lib/orchestrator/` | LangGraph multi-agent graph, intent classifier |
| `src/lib/mcp/` | MCP client, config, document tools |
| `src/lib/bizplan/` | PSST generator, prompts, program templates |
| `src/lib/diagrams/` | Mermaid, charts, Korean business plan diagrams |
| `src/lib/external-apis/` | K-Startup, KOSIS market data, Perplexity |
| `src/lib/scrapers/` | K-Startup, 1688, ScrapeOwl |
| `src/lib/memory/` | Conversation history, session manager (Redis) |
| `src/lib/market-data/` | Korean market data utilities |
| `src/lib/supabase/` | Server/client/admin Supabase clients |
| `src/lib/validation/` | Zod schemas for all inputs |
| `src/lib/auth/` | Authorization helpers |
| `src/lib/observability/` | LangSmith tracing wrapper |

---

## 9. Authentication & Authorization Flow

1. **Middleware** (`src/middleware.ts`): Refreshes Supabase session, attaches correlation ID
2. **Login** (`src/app/login/actions.ts`): `signInWithPassword` / `signUp` via Supabase Auth
3. **Dashboard layout**: Checks auth, redirects to `/login` if unauthenticated
4. **Org context** (`src/lib/org.ts`): Auto-joins demo org on first login
5. **Authorization** (`src/lib/auth/authorization.ts`): `requireAuth()`, `requireOrganizationAccess()`, `requireResourceAccess()`
6. **Sign out** (`/auth/signout`): Clears session, redirects to `/login`

---

## 10. Documentation State

### Fragmented & Contradictory

There are **30+ markdown files** in the repo root and **15+ in handover_notes/**. Key issues:

- `IMPLEMENTATION_STATUS.md` (Jan 6): Claims 60% ready, 6/10 agents
- `PRODUCTION_READINESS_FINAL_REPORT.md` (Jan 7): Claims 95% ready, all 10 hardened
- `SESSION_SUMMARY.md` (Jan 7): Claims only 2/10 agents hardened
- `PRODUCTION_READY_ORCHESTRATOR_HANDOVER.md` (Jan 24): Most recent, focused on orchestrator

**Recommendation:** Consolidate into this handover document + gap analysis + implementation plan. Archive or delete the rest.

---

## 11. Repo Hygiene Issues

- **30+ stale files at repo root**: logs, debug output, temp SQL, multiple overlapping status docs
- **Dual lock files**: Both `package-lock.json` and `pnpm-lock.yaml` exist
- **No `.gitignore` coverage** for: `*.log`, `error*.log`, `debug_output.txt`, `nul`, `status.*`, temp SQL files
- **No automated tests** of any kind
- **No CI/CD** pipeline configuration
- **`env.example`** exists but no `.env.example` (non-standard naming)

---

## 12. Environment Variables Required

Based on code analysis, the following env vars are needed:

```
# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# AI Providers
GOOGLE_GENERATIVE_AI_API_KEY=
OPENAI_API_KEY=
ANTHROPIC_API_KEY=

# External APIs
PERPLEXITY_API_KEY=
KOSIS_API_KEY=

# Redis
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Stripe
STRIPE_SECRET_KEY=
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=

# Kakao
KAKAO_WEBHOOK_SECRET=

# Observability
LANGSMITH_API_KEY=
LANGSMITH_PROJECT=

# Scraping
SCRAPEOWL_API_KEY=

# Feature Flags
ENABLE_MOCK_DATA=true  # Set to false for production

# Organization
DEMO_ORG_ID=
```
